!function(){"use strict";var e="",t=e+"d3610e9c6dce3cb370d8.svg",r=e+"d38272e02bb4f1ab1c37.svg",o=e+"40608da7369d39bc1077.svg",n=e+"d73f076c46eb5467f5fc.svg";const c=(e,t,r)=>{(e=>!!e.some(e=>!e.validity.valid))(e)?(t.disabled=!0,t.classList.add(r.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},a=(e,t,r)=>{t.forEach(t=>{l(e,t,r)})},s={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn-disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},l=(e,t,r)=>{const o=t.id+"-error",n=e.querySelector("#"+o);t.classList.remove(r.inputErrorClass),n.textContent=""};function i(e,t,r,o){e.textContent=t?r:o}const d=document.querySelector("#image1");d.src=t,d.alt="Logo";const u=document.querySelector("#image2"),m=document.querySelector("#image3");m.src=r,m.alt="Edit button img";const h=document.querySelector("#image4");let f,_;h.src=o,h.alt="Plus icon",document.querySelector("#profile__pencil").src=n;const S=document.querySelector("#img-modal"),v=S.querySelector("#profile-img-form"),y=S.querySelector(".modal__close-btn"),p=S.querySelector(".modal__form"),b=p.querySelector("#profile-img-input"),q=document.querySelector(".profile__img-btn"),g=document.querySelector(".profile__edit-btn"),L=document.querySelector("#edit-profile-modal"),k=L.querySelector(".modal__close-btn"),E=document.querySelector(".profile__add-btn"),C=document.querySelector(".profile__name"),A=document.querySelector(".profile__description"),U=L.querySelector(".modal__form"),x=document.querySelector("#new-post-modal"),D=x.querySelector(".modal__form"),I=x.querySelector(".modal__close-btn"),$=x.querySelector(".modal__submit-btn"),R=x.querySelector("#card-img-input"),w=x.querySelector("#card-caption-input"),B=document.querySelector(".cards__list"),P=document.querySelector("#card-template"),T=(P.content.cloneNode(!0).querySelector(".card"),document.querySelector("#delete-modal")),N=T.querySelector(".modal__delete-form"),O=T.querySelector(".modal__submit-btn-cancel"),j=document.querySelector("#preview-modal"),J=j.querySelector(".modal__close-btn"),H=j.querySelector(".modal__image"),z=j.querySelector(".modal__caption"),M=Array.from(U.querySelectorAll(s.inputSelector)),F=document.querySelector("#profile-name-input"),G=document.querySelector("#profile-description-input");function K(e){e.target.classList.contains("modal")&&e.target.classList.contains("modal_is-opened")&&W(e.target)}function Q(e){const t=document.querySelector(".modal_is-opened");"Escape"===e.key&&t&&W(t)}function V(e){e.classList.add("modal_is-opened"),e.addEventListener("mousedown",K),document.addEventListener("keydown",Q)}function W(e){e.classList.remove("modal_is-opened"),e.removeEventListener("mousedown",K),document.removeEventListener("keydown",Q)}function X(e){const t=P.content.cloneNode(!0).querySelector(".card"),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),c=t.querySelector(".card__delete-btn");return e.isLiked&&n.classList.add("card__like-button_active"),n.addEventListener("click",t=>function(e,t){let r=Boolean;r=!!e.target.classList.contains("card__like-button_active"),Y.handleLiked(t,r).then(()=>{e.target.classList.toggle("card__like-button_active")}).catch(e=>{console.log(e)})}(t,e._id)),c.addEventListener("click",r=>{!function(e,t){V(T),f=e,_=t}(t,e._id)}),o.src=e.link,o.alt=e.name,r.textContent=e.name,o.addEventListener("click",()=>{H.src=e.link,H.alt=e.name,z.textContent=e.name,V(j)}),J.addEventListener("click",()=>{W(j)}),t}const Y=new class{constructor({baseUrl:e,headers:t}){this.baseUrl=e,this.headers=t}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then(this._checkResponse)}getUserInfo(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then(this._checkResponse)}editUserInfo({name:e,about:t}){return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}postCard({name:e,link:t}){return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}editAvatarInfo(e){return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then(this._checkResponse)}handleLiked(e,t){return fetch(`${this.baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this.headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"cb2d50ae-6f63-4d7f-a3f6-08c31f11128a","Content-Type":"application/json"}});var Z;Y.getAppInfo().then(([e,t])=>{e.forEach(function(e){const t=X(e);B.append(t)}),C.textContent=t.name,A.textContent=t.about,u.src=t.avatar}).catch(e=>{console.log(e)}),U.addEventListener("submit",function(e){e.preventDefault();const t=e.submitter;i(t,!0,"Saving...","Save"),Y.editUserInfo({name:F.value,about:G.value}).then(e=>{C.textContent=e.name,A.textContent=e.about,W(L)}).catch(e=>{console.log(e)}).finally(()=>{i(t,!1,"Saving...","Save")})}),D.addEventListener("submit",function(e){e.preventDefault();const t=e.submitter;i(t,!0,"Saving...","Save");const r={name:w.value,link:R.value};Y.postCard(r).then(e=>{const t=X(e);B.prepend(t),W(x),D.reset(),c(M,$,s)}).catch(e=>{console.log(e)}).finally(()=>{i(t,!1,"Saving...","Save")})}),N.addEventListener("submit",function(e){const t=e.submitter;i(t,!0,"Deleting...","Delete"),e.preventDefault(),Y.deleteCard(_).then(()=>{f&&f.remove(),W(T)}).catch(e=>{console.log(e)}).finally(()=>{i(t,!1,"Deleting...","Delete")})}),v.addEventListener("submit",function(e){console.log("asdsad"),e.preventDefault();const t=e.submitter;i(t,!0,"Saving...","Save"),Y.editAvatarInfo(b.value).then(e=>{u.src=e.avatar,p.reset(),t.disabled=!0,W(S)}).catch(e=>console.log(e)).finally(()=>{i(t,!1,"Saving...","Save")})}),O.addEventListener("click",e=>{e.preventDefault(),W(T)}),q.addEventListener("click",function(){console.log("afsdsd"),V(S)}),y.addEventListener("click",()=>{W(S)}),g.addEventListener("click",function(){V(L),F.value=C.textContent,G.value=A.textContent,a(U,M,s),c(Array.from(U.querySelectorAll(s.inputSelector)),U.querySelector(s.submitButtonSelector),s)}),k.addEventListener("click",function(){W(L)}),E.addEventListener("click",function(){D.reset();const e=Array.from(D.querySelectorAll(s.inputSelector));a(D,e,s),V(x)}),I.addEventListener("click",function(){W(x)}),Z=s,Array.from(document.querySelectorAll(Z.formSelector)).forEach(e=>{((e,t)=>{const r=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);c(r,o,t),c(r,o,t),r.forEach(n=>{n.addEventListener("input",function(){((e,t,r)=>{t.validity.valid?l(e,t,r):((e,t,r,o)=>{const n=t.id+"-error",c=e.querySelector("#"+n);c.textContent=r,c.classList.add(o.errorClass),t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,r)})(e,n,t),c(r,o,t)})})})(e,Z)})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBjb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XG4gIGNvbnN0IElucHV0TGlzdFZhbGlkaXR5ID0gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiB7XG4gICAgaWYgKCFpbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0pO1xuICBpZiAoSW5wdXRMaXN0VmFsaWRpdHkpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5leHBvcnQgY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfSBlbHNlIHtcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfVxufTtcbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idG4tZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXG59O1xuXG5leHBvcnQgY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBlcnJvck1zZywgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnSUQgPSBpbnB1dEVsLmlkICsgXCItZXJyb3JcIjtcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKFwiI1wiICsgZXJyb3JNc2dJRCk7XG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcbiAgZXJyb3JNc2dFbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5lcnJvckNsYXNzKTtcblxuICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuZXhwb3J0IGNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnSUQgPSBpbnB1dEVsLmlkICsgXCItZXJyb3JcIjtcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKFwiI1wiICsgZXJyb3JNc2dJRCk7XG4gIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcblxuICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gXCJcIjtcbn07XG5cbmV4cG9ydCBjb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcbiAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlLCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1lbCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1lbCwgY29uZmlnKTtcbiAgfSk7XG59O1xuIiwiZXhwb3J0IGZ1bmN0aW9uIHNldEJ1dHRvblRleHQoYnRuLCBpc0xvYWRpbmcsIGxvYWRpbmdUZXh0LCBkZWZhdWx0VGV4dCkge1xuICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgYnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gIH0gZWxzZSB7XG4gICAgYnRuLnRleHRDb250ZW50ID0gZGVmYXVsdFRleHQ7XG4gIH1cbn1cbiIsIi8qSU1QT1JUKi9cbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgaW1hZ2UxIGZyb20gXCIuLi9pbWFnZXMvTG9nby5zdmdcIjtcbmltcG9ydCBpbWFnZTMgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWxfaWNvbi5zdmdcIjtcbmltcG9ydCBpbWFnZTQgZnJvbSBcIi4uL2ltYWdlcy9wbHVzX2ljb24uc3ZnXCI7XG5pbXBvcnQgcHJvZmlsZV9fcGVuY2lsIGZyb20gXCIuLi9pbWFnZXMvcGVjaWxfbGlnaHRfaWNvbi5zdmdcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xuaW1wb3J0IHtcbiAgZW5hYmxlVmFsaWRhdGlvbixcbiAgc2V0dGluZ3MsXG4gIHJlc2V0VmFsaWRhdGlvbixcbiAgdG9nZ2xlQnV0dG9uU3RhdGUsXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCB7IHNldEJ1dHRvblRleHQgfSBmcm9tIFwiLi4vdXRpbHMvaGVscGVyLmpzXCI7XG4vKkNPTlRTIEZPUiBJTUFHRVMgVE8gU0hPVyBPTiBXRUJTSVRFKi9cbmNvbnN0IGltYWdlMUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZTFcIik7XG5pbWFnZTFFbC5zcmMgPSBpbWFnZTE7XG5pbWFnZTFFbC5hbHQgPSBcIkxvZ29cIjtcbmNvbnN0IGltYWdlMkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZTJcIik7XG5cbmNvbnN0IGltYWdlM0VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZTNcIik7XG5pbWFnZTNFbC5zcmMgPSBpbWFnZTM7XG5pbWFnZTNFbC5hbHQgPSBcIkVkaXQgYnV0dG9uIGltZ1wiO1xuY29uc3QgaW1hZ2U0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlNFwiKTtcbmltYWdlNEVsLnNyYyA9IGltYWdlNDtcbmltYWdlNEVsLmFsdCA9IFwiUGx1cyBpY29uXCI7XG4vL0NBUkQgSUQgTEVUXG5sZXQgc2VsZWN0ZWRDYXJkLCBzZWxlY3RlZENhcmRJZDtcblxuLy9BVkFUQVIgSU1BR0VTIEVMRU1FTlRTXG5jb25zdCBwcm9maWxlUGVuY2lsRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX3BlbmNpbFwiKTtcbnByb2ZpbGVQZW5jaWxFbC5zcmMgPSBwcm9maWxlX19wZW5jaWw7XG5jb25zdCBpbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2ltZy1tb2RhbGApO1xuY29uc3QgYXZhdGFyRWRpdEZvcm0gPSBpbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1pbWctZm9ybVwiKTtcbmNvbnN0IGltYWdlQ2xvc2VCdG4gPSBpbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbmNvbnN0IGltYWdlRm9ybSA9IGltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGltYWdlSW5wdXQgPSBpbWFnZUZvcm0ucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWltZy1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVJbWFnZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1nLWJ0blwiKTtcblxuLy9QUk9GSUxFIElORk8gRURJVCBFTEVNRU5UU1xuY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAucHJvZmlsZV9fZWRpdC1idG5gKTtcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjZWRpdC1wcm9maWxlLW1vZGFsYCk7XG5jb25zdCBwcm9maWxlQ2xvc2VCdG4gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoYC5tb2RhbF9fY2xvc2UtYnRuYCk7XG5jb25zdCBwcm9maWxlQWRkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnByb2ZpbGVfX2FkZC1idG5gKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnByb2ZpbGVfX25hbWVgKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5wcm9maWxlX19kZXNjcmlwdGlvbmApO1xuXG5jb25zdCBwcm9maWxlTW9kYWxGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKGAubW9kYWxfX2Zvcm1gKTtcblxuLy9QT1NUIENBUkQgRUxFTUVOVFNcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNuZXctcG9zdC1tb2RhbGApO1xuXG5jb25zdCBwb3N0TW9kYWxGb3JtID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoYC5tb2RhbF9fZm9ybWApO1xuY29uc3QgbmV3UG9zdENsb3NlQnRuID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoYC5tb2RhbF9fY2xvc2UtYnRuYCk7XG5jb25zdCBTYXZlQnV0dG9uID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoYC5tb2RhbF9fc3VibWl0LWJ0bmApO1xuY29uc3QgY2FyZEltZ0xpbmsgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihgI2NhcmQtaW1nLWlucHV0YCk7XG5jb25zdCBjYXJkQ2FwdGlvbklucHV0ID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoYCNjYXJkLWNhcHRpb24taW5wdXRgKTtcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5jb25zdCBjYXJkRnJhZ21lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudC5jbG9uZU5vZGUodHJ1ZSk7XG5jb25zdCBjYXJkRWxlbWVudCA9IGNhcmRGcmFnbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIik7XG5cbi8vREVMRVRJT04gRUxFTUVOVFNcbmNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtbW9kYWxcIik7XG5jb25zdCBkZWxldGVGb3JtID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZGVsZXRlLWZvcm1cIik7XG5jb25zdCBjYW5jZWxEZWxldGVCdG4gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuLWNhbmNlbFwiKTtcblxuLy9QUkVWSUVXIEVMRU1FTlRTXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XG5jb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ0biA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XG5jb25zdCBwcmV2aWV3SW1hZ2VFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbmNvbnN0IHByZXZpZXdDYXB0aW9uRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcblxuY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgcHJvZmlsZU1vZGFsRm9ybS5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmlucHV0U2VsZWN0b3IpXG4pO1xuY29uc3QgcHJvZmlsZU5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwcm9maWxlLW5hbWUtaW5wdXRgKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgYCNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0YFxuKTtcbi8vRlVOQ1RJT05TXG5mdW5jdGlvbiBoYW5kbGVPdmVybGF5Q2xpY2soZXZ0KSB7XG4gIGlmIChcbiAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpICYmXG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9pcy1vcGVuZWRcIilcbiAgKSB7XG4gICAgY2xvc2VNb2RhbChldnQudGFyZ2V0KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgY29uc3Qgb3BlbmVkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX2lzLW9wZW5lZFwiKTtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIgJiYgb3BlbmVkTW9kYWwpIHtcbiAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWxFbGVtZW50KSB7XG4gIG1vZGFsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xuICBtb2RhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVPdmVybGF5Q2xpY2spO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NDbG9zZSk7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWxFbGVtZW50KSB7XG4gIG1vZGFsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xuICBtb2RhbEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVPdmVybGF5Q2xpY2spO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NDbG9zZSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0dGVyID0gZXZ0LnN1Ym1pdHRlcjtcblxuICBzZXRCdXR0b25UZXh0KHN1Ym1pdHRlciwgdHJ1ZSwgXCJTYXZpbmcuLi5cIiwgXCJTYXZlXCIpO1xuICBhcGlcbiAgICAuZWRpdFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IHByb2ZpbGVOYW1lSW5wdXQudmFsdWUsXG4gICAgICBhYm91dDogcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUsXG4gICAgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xuICAgICAgY2xvc2VNb2RhbChwcm9maWxlRWRpdE1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXR0ZXIsIGZhbHNlLCBcIlNhdmluZy4uLlwiLCBcIlNhdmVcIik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZU5ld1Bvc3RGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0dGVyID0gZXZ0LnN1Ym1pdHRlcjtcblxuICBzZXRCdXR0b25UZXh0KHN1Ym1pdHRlciwgdHJ1ZSwgXCJTYXZpbmcuLi5cIiwgXCJTYXZlXCIpO1xuICBjb25zdCBuZXdDYXJkRGF0YSA9IHtcbiAgICBuYW1lOiBjYXJkQ2FwdGlvbklucHV0LnZhbHVlLFxuXG4gICAgbGluazogY2FyZEltZ0xpbmsudmFsdWUsXG4gIH07XG4gIGFwaVxuICAgIC5wb3N0Q2FyZChuZXdDYXJkRGF0YSlcbiAgICAudGhlbigoY2FyZCkgPT4ge1xuICAgICAgY29uc3QgbmV3Q2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkKTtcbiAgICAgIGNhcmRzTGlzdC5wcmVwZW5kKG5ld0NhcmRFbGVtZW50KTtcbiAgICAgIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcbiAgICAgIHBvc3RNb2RhbEZvcm0ucmVzZXQoKTtcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgU2F2ZUJ1dHRvbiwgc2V0dGluZ3MpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdHRlciwgZmFsc2UsIFwiU2F2aW5nLi4uXCIsIFwiU2F2ZVwiKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVJbWFnZVN1Ym1pdChldnQpIHtcbiAgY29uc29sZS5sb2coYGFzZHNhZGApO1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0dGVyID0gZXZ0LnN1Ym1pdHRlcjtcblxuICBzZXRCdXR0b25UZXh0KHN1Ym1pdHRlciwgdHJ1ZSwgXCJTYXZpbmcuLi5cIiwgXCJTYXZlXCIpO1xuXG4gIGFwaVxuICAgIC5lZGl0QXZhdGFySW5mbyhpbWFnZUlucHV0LnZhbHVlKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBkZWJ1Z2dlcjtcbiAgICAgIGltYWdlMkVsLnNyYyA9IGRhdGEuYXZhdGFyO1xuXG4gICAgICBpbWFnZUZvcm0ucmVzZXQoKTtcbiAgICAgIHN1Ym1pdHRlci5kaXNhYmxlZCA9IHRydWU7XG4gICAgICBjbG9zZU1vZGFsKGltYWdlTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXR0ZXIsIGZhbHNlLCBcIlNhdmluZy4uLlwiLCBcIlNhdmVcIik7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBjYXJkSWQpIHtcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcblxuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcbiAgc2VsZWN0ZWRDYXJkSWQgPSBjYXJkSWQ7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChldnQpIHtcbiAgY29uc3Qgc3VibWl0dGVyID0gZXZ0LnN1Ym1pdHRlcjtcblxuICBzZXRCdXR0b25UZXh0KHN1Ym1pdHRlciwgdHJ1ZSwgXCJEZWxldGluZy4uLlwiLCBcIkRlbGV0ZVwiKTtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGFwaVxuICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGlmIChzZWxlY3RlZENhcmQpIHtcbiAgICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgfVxuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0dGVyLCBmYWxzZSwgXCJEZWxldGluZy4uLlwiLCBcIkRlbGV0ZVwiKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGhhbmRsZVRvZ2dsZUxpa2VkKGV2dCwgZGF0YUlkKSB7XG4gIGxldCBpc0xpa2VkID0gQm9vbGVhbjtcbiAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpKSB7XG4gICAgaXNMaWtlZCA9IHRydWU7XG4gIH0gZWxzZSB7XG4gICAgaXNMaWtlZCA9IGZhbHNlO1xuICB9XG4gIGFwaVxuICAgIC5oYW5kbGVMaWtlZChkYXRhSWQsIGlzTGlrZWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcbiAgY29uc3QgY2FyZEZyYWdtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpO1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRGcmFnbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIik7XG4gIGNvbnN0IGNhcmRUaXRsZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltZ0VsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY29uc3QgbGlrZUJ0bkVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgY29uc3QgZGVsZXRlQnRuRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idG5cIik7XG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcbiAgICBsaWtlQnRuRWwuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgfVxuICBsaWtlQnRuRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+XG4gICAgaGFuZGxlVG9nZ2xlTGlrZWQoZXZ0LCBkYXRhLl9pZClcbiAgKTtcblxuICBkZWxldGVCdG5FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEuX2lkKTtcbiAgfSk7XG5cbiAgY2FyZEltZ0VsLnNyYyA9IGRhdGEubGluaztcbiAgY2FyZEltZ0VsLmFsdCA9IGRhdGEubmFtZTtcbiAgY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG5cbiAgY2FyZEltZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHJldmlld0ltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcbiAgICBwcmV2aWV3Q2FwdGlvbkVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICB9KTtcbiAgcHJldmlld01vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjbG9zZU1vZGFsKHByZXZpZXdNb2RhbCk7XG4gIH0pO1xuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbi8vQVBJIFJFUVNcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImNiMmQ1MGFlLTZmNjMtNGQ3Zi1hM2Y2LTA4YzMxZjExMTI4YVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmFwaVxuICAuZ2V0QXBwSW5mbygpXG4gIC50aGVuKChbY2FyZHMsIHVzZXJdKSA9PiB7XG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkKTtcbiAgICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xuICAgIH0pO1xuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlci5uYW1lO1xuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXIuYWJvdXQ7XG4gICAgaW1hZ2UyRWwuc3JjID0gdXNlci5hdmF0YXI7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSk7XG5cbi8vRVZFTlQgTElTVEVORVJTXG5wcm9maWxlTW9kYWxGb3JtLmFkZEV2ZW50TGlzdGVuZXIoYHN1Ym1pdGAsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcbnBvc3RNb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihgc3VibWl0YCwgaGFuZGxlTmV3UG9zdEZvcm1TdWJtaXQpO1xuZGVsZXRlRm9ybS5hZGRFdmVudExpc3RlbmVyKGBzdWJtaXRgLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xuYXZhdGFyRWRpdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihgc3VibWl0YCwgaGFuZGxlUHJvZmlsZUltYWdlU3VibWl0KTtcblxuY2FuY2VsRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpOyAvLyBQcmV2ZW50IGZvcm0gc3VibWlzc2lvbiBpZiBidXR0b24gaXMgaW5zaWRlIHRoZSBmb3JtXG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xufSk7XG5wcm9maWxlSW1hZ2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgY29uc29sZS5sb2coYGFmc2RzZGApO1xuICBvcGVuTW9kYWwoaW1hZ2VNb2RhbCk7XG59KTtcbmltYWdlQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChpbWFnZU1vZGFsKTtcbn0pO1xuXG5wcm9maWxlRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKGBjbGlja2AsIGZ1bmN0aW9uICgpIHtcbiAgb3Blbk1vZGFsKHByb2ZpbGVFZGl0TW9kYWwpO1xuICBwcm9maWxlTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xuICByZXNldFZhbGlkYXRpb24ocHJvZmlsZU1vZGFsRm9ybSwgaW5wdXRMaXN0LCBzZXR0aW5ncyk7XG4gIHRvZ2dsZUJ1dHRvblN0YXRlKFxuICAgIEFycmF5LmZyb20ocHJvZmlsZU1vZGFsRm9ybS5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmlucHV0U2VsZWN0b3IpKSxcbiAgICBwcm9maWxlTW9kYWxGb3JtLnF1ZXJ5U2VsZWN0b3Ioc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3IpLFxuICAgIHNldHRpbmdzXG4gICk7XG59KTtcblxucHJvZmlsZUNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoYGNsaWNrYCwgZnVuY3Rpb24gKCkge1xuICBjbG9zZU1vZGFsKHByb2ZpbGVFZGl0TW9kYWwpO1xufSk7XG5cbnByb2ZpbGVBZGRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgcG9zdE1vZGFsRm9ybS5yZXNldCgpOyAvLyBDbGVhciBwcmV2aW91cyBpbnB1dCB2YWx1ZXNcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICBwb3N0TW9kYWxGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcbiAgKTtcbiAgcmVzZXRWYWxpZGF0aW9uKHBvc3RNb2RhbEZvcm0sIGlucHV0TGlzdCwgc2V0dGluZ3MpO1xuICBvcGVuTW9kYWwobmV3UG9zdE1vZGFsKTtcbn0pO1xubmV3UG9zdENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoYGNsaWNrYCwgZnVuY3Rpb24gKCkge1xuICBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCk7XG59KTtcblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG4iLCIvLyB1dGlscy9BcGkuanNcblxuY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuICBnZXRBcHBJbmZvKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XG4gIH1cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgIC8vIFNlbmQgdGhlIGRhdGEgaW4gdGhlIGJvZHkgYXMgYSBKU09OIHN0cmluZy5cbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcG9zdENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICAvLyBTZW5kIHRoZSBkYXRhIGluIHRoZSBib2R5IGFzIGEgSlNPTiBzdHJpbmcuXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZWRpdEF2YXRhckluZm8oYXZhdGFyKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICAvLyBTZW5kIHRoZSBkYXRhIGluIHRoZSBib2R5IGFzIGEgSlNPTiBzdHJpbmcuXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbiAgZGVsZXRlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBoYW5kbGVMaWtlZChpZCwgaXNMaWtlZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50IiwiY29uZmlnIiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInJlbW92ZSIsInJlc2V0VmFsaWRhdGlvbiIsImZvcm1FbGVtZW50IiwiZm9yRWFjaCIsImlucHV0RWxlbWVudCIsImhpZGVJbnB1dEVycm9yIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiZm9ybUVsIiwiaW5wdXRFbCIsImVycm9yTXNnSUQiLCJpZCIsImVycm9yTXNnRWwiLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJzZXRCdXR0b25UZXh0IiwiYnRuIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJkZWZhdWx0VGV4dCIsImltYWdlMUVsIiwiZG9jdW1lbnQiLCJzcmMiLCJpbWFnZTEiLCJhbHQiLCJpbWFnZTJFbCIsImltYWdlM0VsIiwiaW1hZ2UzIiwiaW1hZ2U0RWwiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImltYWdlNCIsInByb2ZpbGVfX3BlbmNpbCIsImltYWdlTW9kYWwiLCJhdmF0YXJFZGl0Rm9ybSIsImltYWdlQ2xvc2VCdG4iLCJpbWFnZUZvcm0iLCJpbWFnZUlucHV0IiwicHJvZmlsZUltYWdlQnRuIiwicHJvZmlsZUVkaXRCdG4iLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZUNsb3NlQnRuIiwicHJvZmlsZUFkZEJ0biIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZU1vZGFsRm9ybSIsIm5ld1Bvc3RNb2RhbCIsInBvc3RNb2RhbEZvcm0iLCJuZXdQb3N0Q2xvc2VCdG4iLCJTYXZlQnV0dG9uIiwiY2FyZEltZ0xpbmsiLCJjYXJkQ2FwdGlvbklucHV0IiwiY2FyZHNMaXN0IiwiY2FyZFRlbXBsYXRlIiwiZGVsZXRlTW9kYWwiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZGVsZXRlRm9ybSIsImNhbmNlbERlbGV0ZUJ0biIsInByZXZpZXdNb2RhbCIsInByZXZpZXdNb2RhbENsb3NlQnRuIiwicHJldmlld0ltYWdlRWwiLCJwcmV2aWV3Q2FwdGlvbkVsIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsInByb2ZpbGVOYW1lSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImhhbmRsZU92ZXJsYXlDbGljayIsImV2dCIsInRhcmdldCIsImNvbnRhaW5zIiwiY2xvc2VNb2RhbCIsImhhbmRsZUVzY0Nsb3NlIiwib3BlbmVkTW9kYWwiLCJrZXkiLCJvcGVuTW9kYWwiLCJtb2RhbEVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImdldENhcmRFbGVtZW50IiwiZGF0YSIsImNhcmRFbGVtZW50IiwiY2FyZFRpdGxlRWwiLCJjYXJkSW1nRWwiLCJsaWtlQnRuRWwiLCJkZWxldGVCdG5FbCIsImlzTGlrZWQiLCJkYXRhSWQiLCJCb29sZWFuIiwiYXBpIiwiaGFuZGxlTGlrZWQiLCJ0aGVuIiwidG9nZ2xlIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiaGFuZGxlVG9nZ2xlTGlrZWQiLCJfaWQiLCJjYXJkSWQiLCJoYW5kbGVEZWxldGVDYXJkIiwibGluayIsIm5hbWUiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEFwcEluZm8iLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwiZWRpdFVzZXJJbmZvIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInBvc3RDYXJkIiwiZWRpdEF2YXRhckluZm8iLCJhdmF0YXIiLCJkZWxldGVDYXJkIiwiYXV0aG9yaXphdGlvbiIsImNhcmRzIiwidXNlciIsImNhcmQiLCJhcHBlbmQiLCJwcmV2ZW50RGVmYXVsdCIsInN1Ym1pdHRlciIsInZhbHVlIiwiZmluYWxseSIsIm5ld0NhcmREYXRhIiwibmV3Q2FyZEVsZW1lbnQiLCJwcmVwZW5kIiwicmVzZXQiLCJmb3JtZWwiLCJzZXRFdmVudExpc3RlbmVycyIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNc2ciLCJ2YWxpZGF0aW9uTWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=